2025-04-28 05:09:33,447 INFO    MainThread:1138368 [wandb_setup.py:_flush():67] Current SDK version is 0.19.7
2025-04-28 05:09:33,447 INFO    MainThread:1138368 [wandb_setup.py:_flush():67] Configure stats pid to 1138368
2025-04-28 05:09:33,447 INFO    MainThread:1138368 [wandb_setup.py:_flush():67] Loading settings from /nas/longleaf/home/tis/.config/wandb/settings
2025-04-28 05:09:33,448 INFO    MainThread:1138368 [wandb_setup.py:_flush():67] Loading settings from /work/users/t/i/tis/VidMuse/output/VidMuse/xps/6420c4e9/wandb/settings
2025-04-28 05:09:33,448 INFO    MainThread:1138368 [wandb_setup.py:_flush():67] Loading settings from environment variables
2025-04-28 05:09:33,448 INFO    MainThread:1138368 [wandb_init.py:setup_run_log_directory():647] Logging user logs to /work/users/t/i/tis/VidMuse/output/VidMuse/xps/6420c4e9/wandb/run-20250428_050933-6420c4e9/logs/debug.log
2025-04-28 05:09:33,448 INFO    MainThread:1138368 [wandb_init.py:setup_run_log_directory():648] Logging internal logs to /work/users/t/i/tis/VidMuse/output/VidMuse/xps/6420c4e9/wandb/run-20250428_050933-6420c4e9/logs/debug-internal.log
2025-04-28 05:09:33,448 INFO    MainThread:1138368 [wandb_init.py:init():761] calling init triggers
2025-04-28 05:09:33,448 INFO    MainThread:1138368 [wandb_init.py:init():766] wandb.init called with sweep_config: {}
config: {'_wandb': {}}
2025-04-28 05:09:33,448 INFO    MainThread:1138368 [wandb_init.py:init():784] starting backend
2025-04-28 05:09:33,448 INFO    MainThread:1138368 [wandb_init.py:init():788] sending inform_init request
2025-04-28 05:09:33,464 INFO    MainThread:1138368 [backend.py:_multiprocessing_setup():97] multiprocessing start_methods=fork,spawn,forkserver, using: spawn
2025-04-28 05:09:33,464 INFO    MainThread:1138368 [wandb_init.py:init():803] backend started and connected
2025-04-28 05:09:33,474 INFO    MainThread:1138368 [wandb_init.py:init():896] updated telemetry
2025-04-28 05:09:33,559 INFO    MainThread:1138368 [wandb_init.py:init():920] communicating run to backend with 90.0 second timeout
2025-04-28 05:09:34,228 INFO    MainThread:1138368 [wandb_init.py:init():995] starting run threads in backend
2025-04-28 05:09:35,376 INFO    MainThread:1138368 [wandb_run.py:_console_start():2377] atexit reg
2025-04-28 05:09:35,377 INFO    MainThread:1138368 [wandb_run.py:_redirect():2227] redirect: wrap_raw
2025-04-28 05:09:35,379 INFO    MainThread:1138368 [wandb_run.py:_redirect():2292] Wrapping output streams.
2025-04-28 05:09:35,379 INFO    MainThread:1138368 [wandb_run.py:_redirect():2317] Redirects installed.
2025-04-28 05:09:35,401 INFO    MainThread:1138368 [wandb_init.py:init():1037] run started, returning control to user process
2025-04-28 05:09:49,878 INFO    MainThread:1138368 [wandb_run.py:_config_callback():1261] config_cb None None {'device': 'cuda', 'dtype': 'float32', 'autocast': True, 'autocast_dtype': 'float16', 'seed': 2036, 'show': False, 'continue_from': '//pretrained/facebook/musicgen-small', 'execute_only': 'None', 'execute_inplace': False, 'benchmark_no_load': False, 'efficient_attention_backend': 'torch', 'num_threads': 1, 'mp_start_method': 'forkserver', 'label': 'None', 'logging.level': 'INFO', 'logging.log_updates': 10, 'logging.log_tensorboard': True, 'logging.log_wandb': True, 'tensorboard.with_media_logging': False, 'tensorboard.name': 'None', 'tensorboard.sub_dir': 'None', 'wandb.with_media_logging': True, 'wandb.project': 'V2M', 'wandb.name': 'training1', 'wandb.group': 'training', 'slurm.gpus': 8, 'slurm.mem_per_gpu': 64, 'slurm.time': 10080, 'slurm.constraint': 'None', 'slurm.partition': 'l40-gpu', 'slurm.comment': 'None', 'slurm.setup': '[\'source ~/.bashrc\', \'echo "FFMPEG located at $(which ffmpeg)"\', \'echo "$(ffmpeg -version)"\', \'cd /work/users/t/i/tis/VidMuse\', \'source .venv/bin/activate\']', 'slurm.exclude': 'None', 'slurm.qos': 'gpu_access', 'slurm.cpus_per_gpu': 4, 'slurm.one_task_per_node': False, 'dora.dir': '/checkpoint/tis/experiments/audiocraft/outputs', 'dora.exclude': "['device', 'wandb.*', 'tensorboard.*', 'logging.*', 'dataset.num_workers', 'eval.num_workers', 'special.*', 'metrics.visqol.bin', 'metrics.fad.bin', 'execute_only', 'execute_best', 'generate.every', 'optim.eager_sync', 'profiler.*', 'deadlock.*', 'efficient_attention_backend', 'num_threads', 'mp_start_method']", 'dora.use_rendezvous': False, 'dora.git_save': True, 'datasource.max_sample_rate': 44100, 'datasource.max_channels': 2, 'datasource.train': '/work/users/t/i/tis/VidMuse/egs/V2M20K/train', 'datasource.valid': '/work/users/t/i/tis/VidMuse/egs/V2M20K/valid', 'datasource.evaluate': '/work/users/t/i/tis/VidMuse/egs/V2M20K/eval', 'datasource.generate': '/work/users/t/i/tis/VidMuse/egs/V2M20K/eval', 'solver': 'musicgen', 'fsdp.use': False, 'fsdp.param_dtype': 'float16', 'fsdp.reduce_dtype': 'float32', 'fsdp.buffer_dtype': 'float32', 'fsdp.sharding_strategy': 'shard_grad_op', 'fsdp.per_block': True, 'profiler.enabled': False, 'deadlock.use': True, 'deadlock.timeout': 600, 'dataset.batch_size': 8, 'dataset.num_workers': 3, 'dataset.segment_duration': 29, 'dataset.num_samples': 'None', 'dataset.return_info': True, 'dataset.shuffle': False, 'dataset.sample_on_duration': False, 'dataset.sample_on_weight': False, 'dataset.min_segment_ratio': 0.8, 'dataset.train.num_samples': 13293, 'dataset.train.shuffle': True, 'dataset.train.shuffle_seed': 0, 'dataset.train.permutation_on_files': False, 'dataset.train.merge_text_p': 0.25, 'dataset.train.drop_desc_p': 0.5, 'dataset.train.drop_other_p': 0.5, 'dataset.valid.num_samples': 1899, 'dataset.evaluate.num_samples': 1, 'dataset.generate.num_samples': 1, 'dataset.generate.return_info': True, 'checkpoint.save_last': True, 'checkpoint.save_every': 1, 'checkpoint.keep_last': 1, 'checkpoint.keep_every_states': 'None', 'generate.every': 1, 'generate.path': 'samples', 'generate.audio.format': 'wav', 'generate.audio.strategy': 'loudness', 'generate.audio.sample_rate': 32000, 'generate.audio.loudness_headroom_db': 14, 'generate.lm.use_sampling': True, 'generate.lm.temp': 1.0, 'generate.lm.top_k': 250, 'generate.lm.top_p': 0.0, 'generate.lm.prompted_samples': True, 'generate.lm.unprompted_samples': True, 'generate.lm.gen_gt_samples': False, 'generate.lm.prompt_duration': 'None', 'generate.lm.gen_duration': 'None', 'generate.lm.remove_prompts': False, 'generate.num_workers': 5, 'evaluate.every': 1, 'evaluate.num_workers': 5, 'evaluate.truncate_audio': 'None', 'evaluate.fixed_generation_duration': 'None', 'evaluate.metrics.base': False, 'evaluate.metrics.fad': False, 'evaluate.metrics.kld': False, 'evaluate.metrics.text_consistency': False, 'evaluate.metrics.chroma_cosine': False, 'optim.epochs': 10, 'optim.updates_per_epoch': 208, 'optim.lr': 3.5e-05, 'optim.optimizer': 'adamw', 'optim.adam.betas': '[0.9, 0.95]', 'optim.adam.weight_decay': 0.1, 'optim.adam.eps': 1e-08, 'optim.ema.use': True, 'optim.ema.updates': 10, 'optim.ema.device': 'cuda', 'optim.ema.decay': 0.99, 'optim.max_norm': 1.0, 'optim.eager_sync': True, 'schedule.lr_scheduler': 'cosine', 'schedule.step.step_size': 'None', 'schedule.step.gamma': 'None', 'schedule.exponential.lr_decay': 'None', 'schedule.cosine.warmup': 4000, 'schedule.cosine.lr_min_ratio': 0.0, 'schedule.cosine.cycle_length': 1.0, 'schedule.polynomial_decay.warmup': 'None', 'schedule.polynomial_decay.zero_lr_warmup_steps': 0, 'schedule.polynomial_decay.end_lr': 0.0, 'schedule.polynomial_decay.power': 1, 'schedule.inverse_sqrt.warmup': 'None', 'schedule.inverse_sqrt.warmup_init_lr': 0.0, 'schedule.linear_warmup.warmup': 'None', 'schedule.linear_warmup.warmup_init_lr': 0.0, 'classifier_free_guidance.training_dropout': 0.3, 'classifier_free_guidance.inference_coef': 3.0, 'fuser.cross_attention_pos_emb': False, 'fuser.cross_attention_pos_emb_scale': 1, 'fuser.sum': '[]', 'fuser.prepend': '[]', 'fuser.cross': "['description']", 'fuser.input_interpolate': '[]', 'conditioners.description.model': 't5', 'conditioners.description.t5.name': 't5-base', 'conditioners.description.t5.finetune': False, 'conditioners.description.t5.word_dropout': 0.3, 'conditioners.description.t5.normalize_text': False, 'sample_rate': 32000, 'channels': 1, 'compression_model_checkpoint': '//pretrained/facebook/encodec_32khz', 'compression_model_n_q': 'None', 'tokens.padding_with_special_token': False, 'interleave_stereo_codebooks.use': False, 'interleave_stereo_codebooks.per_timestep': False, 'cache.path': 'None', 'cache.write': False, 'cache.write_shard': 0, 'cache.write_num_shards': 1, 'metrics.fad.use_gt': False, 'metrics.fad.model': 'tf', 'metrics.fad.tf.bin': 'None', 'metrics.fad.tf.model_path': '//reference/fad/vggish_model.ckpt', 'metrics.kld.use_gt': False, 'metrics.kld.model': 'passt', 'metrics.kld.passt.pretrained_length': 20, 'metrics.text_consistency.use_gt': False, 'metrics.text_consistency.model': 'clap', 'metrics.text_consistency.clap.model_path': '//reference/clap/music_audioset_epoch_15_esc_90.14.pt', 'metrics.text_consistency.clap.model_arch': 'HTSAT-base', 'metrics.text_consistency.clap.enable_fusion': False, 'metrics.chroma_cosine.use_gt': False, 'metrics.chroma_cosine.model': 'chroma_base', 'metrics.chroma_cosine.chroma_base.sample_rate': 32000, 'metrics.chroma_cosine.chroma_base.n_chroma': 12, 'metrics.chroma_cosine.chroma_base.radix2_exp': 14, 'metrics.chroma_cosine.chroma_base.argmax': True, 'lm_model': 'transformer_lm', 'codebooks_pattern.modeling': 'delay', 'codebooks_pattern.delay.delays': '[0, 1, 2, 3]', 'codebooks_pattern.delay.flatten_first': 0, 'codebooks_pattern.delay.empty_initial': 0, 'codebooks_pattern.unroll.flattening': '[0, 1, 2, 3]', 'codebooks_pattern.unroll.delays': '[0, 0, 0, 0]', 'codebooks_pattern.music_lm.group_by': 2, 'codebooks_pattern.coarse_first.delays': '[0, 0, 0]', 'transformer_lm.dim': 1024, 'transformer_lm.num_heads': 16, 'transformer_lm.num_layers': 24, 'transformer_lm.hidden_scale': 4, 'transformer_lm.n_q': 4, 'transformer_lm.card': 2048, 'transformer_lm.dropout': 0.0, 'transformer_lm.emb_lr': 'None', 'transformer_lm.activation': 'gelu', 'transformer_lm.norm_first': True, 'transformer_lm.bias_ff': False, 'transformer_lm.bias_attn': False, 'transformer_lm.bias_proj': False, 'transformer_lm.past_context': 'None', 'transformer_lm.causal': True, 'transformer_lm.custom': False, 'transformer_lm.memory_efficient': True, 'transformer_lm.attention_as_float32': False, 'transformer_lm.layer_scale': 'None', 'transformer_lm.positional_embedding': 'sin', 'transformer_lm.xpos': False, 'transformer_lm.checkpointing': 'none', 'transformer_lm.weight_init': 'gaussian', 'transformer_lm.depthwise_init': 'current', 'transformer_lm.zero_bias_init': True, 'transformer_lm.norm': 'layer_norm', 'transformer_lm.cross_attention': False, 'transformer_lm.qk_layer_norm': False, 'transformer_lm.qk_layer_norm_cross': False, 'transformer_lm.attention_dropout': 'None', 'transformer_lm.kv_repeat': 1, 'transformer_lm.two_step_cfg': False, 'video.visual_encoder': 'clip', 'video.video_fps': 2, 'video.video_overlap': 0, 'video.add_global.if_add_gobal': True, 'video.add_global.global_feature_path': '', 'video.add_global.mode': 'average', 'video.add_global.num_frames': 64}
2025-04-28 22:49:46,850 WARNING MsgRouterThr:1138368 [router.py:message_loop():77] message_loop has been closed
Traceback (most recent call last):
  File "/work/users/t/i/tis/VidMuse/.venv/lib/python3.9/site-packages/wandb/sdk/interface/router_sock.py", line 28, in _read_message
    resp = self._sock_client.read_server_response(timeout=1)
  File "/work/users/t/i/tis/VidMuse/.venv/lib/python3.9/site-packages/wandb/sdk/lib/sock_client.py", line 285, in read_server_response
    data = self._read_packet_bytes(timeout=timeout)
  File "/work/users/t/i/tis/VidMuse/.venv/lib/python3.9/site-packages/wandb/sdk/lib/sock_client.py", line 270, in _read_packet_bytes
    raise SockClientClosedError
wandb.sdk.lib.sock_client.SockClientClosedError

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/work/users/t/i/tis/VidMuse/.venv/lib/python3.9/site-packages/wandb/sdk/interface/router.py", line 70, in message_loop
    msg = self._read_message()
  File "/work/users/t/i/tis/VidMuse/.venv/lib/python3.9/site-packages/wandb/sdk/interface/router_sock.py", line 30, in _read_message
    raise MessageRouterClosedError from e
wandb.sdk.interface.router.MessageRouterClosedError
2025-04-28 22:49:46,869 INFO    MsgRouterThr:1138368 [mailbox.py:close():115] Closing mailbox, abandoning 1 handles.
